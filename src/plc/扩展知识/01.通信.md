---
title: 01.通信
order: 01
---

## 0.0通信协议应用场景

先划分职责，CPU和现场通信首选DP通信（PN协议）

### CPU与现场通信

![image-20250305171924279](./img/image-20250305171924279.png)

### CPU与CPU图形

![image-20250305172209578](./img/image-20250305172209578.png)

![image-20250305172320353](./img/image-20250305172320353.png)

首选S7协议。不过S7是秒级通信，PN/DP通信是毫秒级通信

如果想要高实时性，可以将CPU制作成PN从站。

![image-20250305172422682](./img/image-20250305172422682.png)

如果两个CPU都不支持将设备配置为智能从站，那就加模块。

![image-20250305172438862](./img/image-20250305172438862.png)

### 总结

![image-20250305172639113](./img/image-20250305172639113.png)

### 异常诊断框架

问题诊断流程

![image-20250305163007691](./img/image-20250305163007691.png)

![image-20250305163415186](./img/image-20250305163415186.png)

![image-20250305171212494](./img/image-20250305171212494.png)

### 常见问题

#### 一台PLC可以与几台PLC通信？有什么限制

DP设备

![image-20250305173702806](./img/image-20250305173702806.png)

IO设备

![image-20250305174320106](./img/image-20250305174320106.png)

S7通信

![image-20250305174517234](./img/image-20250305174517234.png)





## 01.基础知识

通信三要素：协议、角色、网络。

协议：S7、modbus、Profinet-DP、Profinet-IO

网络：硬件安装规则，网口、串口

角色：软件网络组态。主从

![image-20250305145052489](./img/image-20250305145052489.png)

通信有两种方式，串口与网口。

### Profinet-DP通信

![image-20250305144144595](./img/image-20250305144144595.png)

应用场景：



### Profinet-IO通信

![image-20250305144438066](./img/image-20250305144438066.png)

应用场景：

![image-20250305144544115](./img/image-20250305144544115.png)

主控

![image-20250305144605199](./img/image-20250305144605199.png)

### S7协议

![image-20250305144846377](./img/image-20250305144846377.png)

S7是应用层协议。

场景

![image-20250305144917244](./img/image-20250305144917244.png)



### 注意

实际场景中一定要沟通好谁是主站设备，谁说从设备。确定好角色，才能开发好项目。

## 2. Profinet DP协议详解

![image-20250305145429696](./img/image-20250305145429696.png)

dp协议主要是解决控制层与现场层通信的问题。

![image-20250305145644939](./img/image-20250305145644939.png)



### 常见参数

PROFIBUS DP

- 通讯数据/设备     244 Bytes输入/输出
- 站点个数              32站点/单网段、124个从站/整个网络
- 通讯网络长度       1000m(由波特率决定)
- 通讯站点地址       拨码开关设置地址
- 传输速率               最大12Mbps,典型1.5Mbps
- 网络拓扑               标准线性网络（可有OLM实现星型或环形）

网络长度：

| 波特率      | 9.6-187.5kbit/s | 500 kbit/s | 1.5 Mbit/s | 3-12 Mbit/s |
| ----------- | --------------- | ---------- | ---------- | ----------- |
| 电缆长度(m) | 1000            | 400        | 200        | 100         |

### 工业现场常见DP网络拓扑

![image-20250305150257712](./img/image-20250305150257712.png)

## 3.PN-IO通信（Profinet-io）

![image-20250305150534974](./img/image-20250305150534974.png)

### 关键参数

常见参数
PROFINET-IO

- 通讯数据/设备      1440 Bytes输入/输出
- 节点个数                如CPU每个接口250个【具体数量查看技术数据】
- 通讯网络长度        电：最长100m,光：Km级
- 通讯站点地址       软件分配、自动分配
- 传输速率               100Mbps
- 网络拓扑               非常灵活，线型，星型，树型，环形

### 网络拓扑

![image-20250305150848142](./img/image-20250305150848142.png)

非常灵活，可以以自己需要的方式随意组网。

## 4.S7协议

![image-20250305151125821](./img/image-20250305151125821.png)

控制层间的通信。控制与操作层直接按的通信。

![image-20250305151112890](./img/image-20250305151112890.png)

## 5.RS485串口网络

![image-20250305151313708](./img/image-20250305151313708.png)

通过9针串口连接。。最主要的是3、8			

**485的A相（负极）与B相（正极）**

![image-20250305151514770](./img/image-20250305151514770.png)

### 使用自己做的网线时

![image-20250305151600388](./img/image-20250305151600388.png)



## 6.以太网网络

![image-20250305151733822](./img/image-20250305151733822.png)

西门子的网线组成

![image-20250305151839960](./img/image-20250305151839960.png)

## 7.角色详解

### 控制器与设备

![image-20250305152036107](./img/image-20250305152036107.png)

### 主站与从站

![image-20250305152215772](./img/image-20250305152215772.png)

### 服务器与客户端

![image-20250305152358942](./img/image-20250305152358942.png)

## 8.硬件安装规则

### 485串口连接

网络拓扑

![image-20250305152914863](./img/image-20250305152914863.png)

详细连接方式。

![image-20250305152637606](./img/image-20250305152637606.png)

安装时，开始与结束都从进线端连接。且连接上终端电阻。。中间的设备，进出按标识即可，且不需要加终端电阻。

常用规则总结：
1.终端电阻
2.进线位置
1D:91373210/84630278（西门子手册ID）



更多硬件安装
规则参考：
物理站点个数
通讯距离与波特率
中继器/OLM

![image-20250305153118012](./img/image-20250305153118012.png)

### 以太网连接

![image-20250305153252002](./img/image-20250305153252002.png)

常用规则总结：
1.线形连接
2.星形连接

## 9.软件组态规则

![image-20250305153631426](./img/image-20250305153631426.png)

现场总线协议

### 过程IO映射



![image-20250305154155903](./img/image-20250305154155903.png)

非cpu处理

![image-20250305153922448](./img/image-20250305153922448.png)

![image-20250305154019857](./img/image-20250305154019857.png)

CPU处理

![image-20250305155153828](./img/image-20250305155153828.png)

### 物理485通信处理

![image-20250305155618662](./img/image-20250305155618662.png)

站号处理，从站可以通过拨码开关设置站号

### 网络配置

设备组态。

![image-20250305155759994](./img/image-20250305155759994.png)

![image-20250305155843677](./img/image-20250305155843677.png)

设备不存在可以在西门子官网找，也可以直接导入GSD文件。

![image-20250305155953301](./img/image-20250305155953301-1741161593894-1.png)

分配组态的名称和网络

![image-20250305160026387](./img/image-20250305160026387.png)

设置IO

### S7

![image-20250305160059476](./img/image-20250305160059476-1741161659862-3.png)

#### 单边通信

![image-20250305160209855](./img/image-20250305160209855.png)



#### 双边通信

![image-20250305160259190](./img/image-20250305160259190.png)

组态角色

![image-20250305160343353](./img/image-20250305160343353.png)

### PB-DP软件组态规则：

1组态角色(主站从站)
2设置站地址与引0地址

## 10.实战

### PN-DP通信步骤

![image-20250305160633971](./img/image-20250305160633971.png)



### S7单边通信配置

![image-20250305170316316](./img/image-20250305170316316.png)

![image-20250305170357262](./img/image-20250305170357262.png)
